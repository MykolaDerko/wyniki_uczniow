---
title: "Projekt"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

# Wstęp

## Opis problemu

Problemem, który analizujemy w niniejszym projekcie jest wpływ poszczególnych czynników na wynik końcowy ucznia (?)

## Baza danych

Baza danych którą analizujemy nazywa się „Wyniki uczniów”. Znajduje się w niej 20 kolumn z danymi oraz 6.608 wierszy danych. W bazie danych znajdują się zarówno zmienne liczbowe jak i jakościowe.

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(
	eval = FALSE,
	warning = FALSE,
	cache = TRUE,
	include = FALSE
)
library(tidyverse)
library(VIM)
library(outliers)
library(naniar)
library(dplyr)
library(hot.deck)
library(dlookr)
library(validate)
library(errorlocate)
library(datarium)
library(ggplot2)
library(gridExtra)
library(hexbin)
library(knitr)
library(gt)
library(corrplot)
```

```{r warning=FALSE, include=FALSE}
glimpse(czynniki)
```

# Czyszczenie danych

W niniejszym rozdziale sprawdzimy jakość danych, zbadamy występowanie braków danych oraz dobierzemy odpowiednią metodę imputacji brakujących danych (jeżeli zajdzie taka potrzeba).

## Walidacja danych

Zostało wykonane badanie danych za pomocą funkcji *aggr*. Wykres po lewej stronie prezentuje proporcje braków danych. W naszym przypadku największe braki występują w trzech zmiennych:

-   Sleep Hours - 5,22%
-   Exam Score - 4,37%
-   Distance from Home - 1,01%

Tabela po prawej stronie ilistruje współwystępowanie braków w zestawie danych. Czerwone pola oznaczają brakujące wartości. Można zauważyć, że brakujące dane są dość rozporoszone i nie występują jednocześnie w wielu zmiennych. Oznacza to, że nie instnieje współzależność pomiędzy występowaniem braków więc dane brakujące będziemy uzupełniać za pomocą podobieństwa.

```{r warning=FALSE, include=FALSE}
aggr(czynniki, numbers = TRUE, sortVars = TRUE)
```

```{r warning=FALSE, include=FALSE}
gg_miss_upset(czynniki)
```

Wykres poniżej został stworzony za pomocą funkcji *gg_miss_upset*. Prezentuje on wartości liczbowe brakujących danych

-   Family income – 309
-   Sleep Hours – 300

Z uwagi na stosunkowo wysoką ilość braków dokonamy imputacji danych.

```{r echo=TRUE, warning=FALSE}
czynniki1<- czynniki[!is.na(czynniki$Family_Income), ]
czynniki2<- czynniki1[!is.na(czynniki1$Parental_Education_Level), ]
czynniki3<- czynniki2[!is.na(czynniki2$Teacher_Quality), ]
czynniki4<- czynniki3[!is.na(czynniki3$Distance_from_Home), ]
unique(czynniki4$Family_Income)
unique(czynniki4$Parental_Education_Level)
unique(czynniki4$Teacher_Quality)
unique(czynniki4$Distance_from_Home)
glimpse(czynniki4)
```

```{r warning=FALSE, include=FALSE}
gg_miss_upset(czynniki4)
```

```{r warning=FALSE, include=FALSE}
aggr(czynniki4, numbers = TRUE, sortVars = TRUE)
```

## Imputacja danych

Dokonujemy imputacji danych dla zmiennych *Exam_score* oraz *Sleep_hours* za pomocą komendy *hotdeck*. Następnie za pomocą komendy *miss_var_summary* sprawdzamy, czy imputacja zakończyła się powodzeniem. W naszym przypadku tak się stało, więc możemy przejśc do następnego kroku.

```{r}
as.numeric(czynniki4$Exam_Score)
as.numeric(czynniki4$Sleep_Hours)
czynniki5 <- hotdeck(czynniki4)
```

```{r}
miss_var_summary(czynniki5)
```

## Reguły walidacyjne

W nineijszym rodziale tworzymy reguły walidacyjne, aby zapewnić poprawność i spójność danych. Stosujemy poniższe reguły:

-   Wartość zmiennej *Hours_Studied* musi mieścić się w przedziale od 0 do 168 (poniważ pokazuje ona ilość godzin spędzanych na nauce tygodniowo)

-   Wartość zmiennej *Phisical_Activity* musi mieścić się w przedziale od 0 do 168 (poniważ pokazuje ona ilość godzin spędzanych na aktywności fizycznej tygodniowo)

-   Wartość zmiennej *Sleep_Hous* musi mieścić się w przedziale od 0 do 24 (ponieważ pokazuje ona ilość przesanych godzin dziennie)

-   Wartość zmiennej *Attendance* musi mieścić się w przedziale od 0 do 10 (poniważ jest wartością procentową)

-   Wartość zmiennej *Previos_Scores* musi mieścić się w przedziale od 0 do 10 (poniważ jest wartością procentową)

-   Wynik równania *Sleep_Hours* \* 7 + *Hours_Studied* + *Phisical_Activity* musi zawierać się w przedziale od 0 do 168 (mnożymy średnią dzienną ilość snu \* 7, aby uzyskć wartośc tygodniową oraz dodajemy tygodniową ilość nauki oraz aktywności fizycznej, a następnie nakazujemy aby wartość była dodatnia, lecz mniejsza niż ilość godzin w tygodniu)

Jak widać na poniższym wykresie walidacja została zakończona sukcesem.

```{r echo=FALSE}
rules <- validator(
Hours_Studied >= 0,
Hours_Studied <= 168,
Attendance >= 0, 
Attendance <= 100,
Sleep_Hours >= 0,
Sleep_Hours <= 24, 
Previous_Scores >= 0, 
Previous_Scores <= 100, 
Physical_Activity >= 0,
Physical_Activity <= 168,
Exam_Score >= 0,
Exam_Score <= 100,
Sleep_Hours * 7 + Hours_Studied + Physical_Activity >= 0,
Sleep_Hours * 7 + Hours_Studied + Physical_Activity <= 168
)

wyniki <- confront(czynniki5, rules)
summary(wyniki)
plot(wyniki)

dane_zwalidowane <- czynniki5 %>%
  replace_errors(rules)
errors_removed(dane_zwalidowane)
```

## Wartości odstające

W tym rodziale za pomocą wykresów pudełkowych przestawiliśmy wartości odstające. Jak widać na poniższych wykresach zdarzają się wartości odstające. Szczeglnie w zmiennych *Exam_Score* oraz *Tutoring_Sessions*.

```{r eval=FALSE, warning=FALSE, include=FALSE}
boxplot(czynniki$Hours_Studied, main="Hours Studied") 
outliers <- boxplot.stats(dane_zwalidowane$Hours_Studied)$out 
print(outliers)
boxplot(czynniki$Attendance, main="Attendance")
outliers1 <- boxplot.stats(dane_zwalidowane$Attendance)$out 
print(outliers1)
boxplot(czynniki$Sleep_Hours, main="Sllep Hours")
outliers2 <- boxplot.stats(dane_zwalidowane$Sllep_hours)$out 
print(outliers2)
boxplot(czynniki$Previous_Scores, main="Previos Scores")
outliers3 <- boxplot.stats(dane_zwalidowane$Previous_Scores)$out 
print(outliers3)
boxplot(czynniki$Tutoring_Sessions, main="Tutoring Sessions")
outliers4 <- boxplot.stats(dane_zwalidowane$Tutoring_Sessions)$out 
print(outliers4)
boxplot(czynniki$Exam_Score, main="Exam Score")
outliers5 <- boxplot.stats(dane_zwalidowane$Exam_Score)$out 
print(outliers5)
```

```{r echo=FALSE, warning=FALSE}
par(mfrow=c(2,3))
boxplot(dane_zwalidowane$Hours_Studied, main="Hours Studied") 
boxplot(dane_zwalidowane$Attendance, main="Attendance")
boxplot(dane_zwalidowane$Sleep_Hours, main="Sllep Hours")
boxplot(dane_zwalidowane$Previous_Scores, main="Previos Scores")
boxplot(dane_zwalidowane$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(dane_zwalidowane$Exam_Score, main="Exam Score")
par(mfrow=c(2,3)) #zmienić przy kolejnych wykresach na c(1,1) bo będzie pamiętać i tworzyć wykresy w blokach 6- wykresowych
boxplot(dane_zwalidowane$Hours_Studied, main="Hours Studied") 
boxplot(dane_zwalidowane$Attendance, main="Attendance")
boxplot(dane_zwalidowane$Sleep_Hours, main="Sllep Hours")
boxplot(dane_zwalidowane$Previous_Scores, main="Previos Scores")
boxplot(dane_zwalidowane$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(dane_zwalidowane$Exam_Score, main="Exam Score")

```

```{r eval=FALSE, warning=FALSE, include=FALSE}
ggplot(dane_zwalidowane, aes(x=Attendance)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Hours_Studied)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Sleep_Hours)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Previous_Scores)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Tutoring_Sessions)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Exam_Score)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
```

Za pomocą komendy *grubbs.test* przeprowadziliśmy test Grubbsa, który służy do wykrywania pojedyńczych wartości odstających w zbiorze danych.

Interpretacja:

-   dla zmiennej *Hours_Studied* - brak odstających wartości

-   dla zmiennej *Attendance* - brak odstających wartości

-   dla zmiennej *Sleep_Hours* - brak odstających wartości

-   dla zmiennej *Previous_Scores* - brak odstających wartości

-   dla zmiennej *Tutoring_Sessions* - wartość 8 jest istotnie odstająca, lecz realna, więc nie zostanie usunięta ze zbioru danych

-   dla zmiennej *Exam_Score* - wartość 100 jest istotnie odstającac, lecz realna, więc nie zostanie usunięta ze zbioru danych

```{r echo=FALSE, warning=FALSE}
grubbs.test(dane_zwalidowane$Hours_Studied)
grubbs.test(dane_zwalidowane$Attendance)
grubbs.test(dane_zwalidowane$Sleep_Hours)
grubbs.test(dane_zwalidowane$Previous_Scores)
grubbs.test(dane_zwalidowane$Tutoring_Sessions)
grubbs.test(dane_zwalidowane$Exam_Score)
```

# Analiza danych 

Jak widać na wykresie poniżej, w próbce dominują mężczyźni. W zbiorze znajduje się 42 % kobiet oraz 58 % mężczyzn.

```{r echo=FALSE, warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Gender, fill = Gender))+
  geom_bar()+
  scale_fill_manual(values =c("Female"="pink","Male"="lightblue"))+
  theme_minimal()+
  ggtitle("Podział płci w próbie")+
  theme(plot.title = element_text(hjust =0.5))
```

Jak widać na załączonym histogramie rozkładu zmiennej *Exam_Score* większość wyników egzaminów mieści się w zakresie 60-75 punktów. Najwięcej studentów uzyskało wynik 65-70 punktów. Wyniki powyżej 80 punktów są rzadkością.

```{r echo=FALSE, warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Exam_Score, fill = Exam_Score))+
  geom_histogram(binwidth =5,fill="#5C1C81", color ="black")+
  theme_minimal()+
  ggtitle("Rozkład wyników egzaminów")+
  theme(plot.title = element_text(hjust =0.5))
```

Na wykresie po lewej (kolor niebiski) przedawiono wyniki egzaminów z podziałem na płcie. Zarowno kobiety, jak i mężczyni w większości uzyskiwali wyniki w zakresie 60-75 punktów. W przypadku mężczyzn widać więcej wyników w górnej części skali (powyżej 75), lecz nie są to duże różnice. Wyniki powyżej 80 punktów są rzzadkością w obu grupach.

Wykres po prawej (kolor zielony) pokazuje ilość godzin poświęconych na naukę tygodniowo w podziale na płcie. W obu grupach większość uczy się 15-25 godzin tygodniowo. Nauka powyżej 40 godzin tygodiowo jest żadkością w obu grupach.

```{r echo=FALSE, warning=FALSE}
 w1 <- ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="steelblue", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Liczba uczniów")+
  facet_grid(~Gender)
w2 <-ggplot(dane_zwalidowane, aes(x = Hours_Studied))+
  geom_histogram(binwidth =5, fill ="darkgreen", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład godzin nauki", x ="Godziny nauki w tygodniu", y="Liczba uczniów")+
  facet_grid(~Gender)
grid.arrange(w1, w2, nrow = 1)
```

Poniższy wykres rozrzutu przestawia relację między zmienną *Hours_Studied* a *Exam_Score*. Czerowna linia regresji sugeruje lekkko poytywną korelację - więcej godzin nauki często wiąże się z lepszym wynikiem. Widzimy, że większość studentów uczy się od 5 do 30 godzin tygodniowo i osiąga wyniki z przedziału 60-80.

```{r echo=FALSE, warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Hours_Studied, y = Exam_Score))+
  geom_point(color ="blue", alpha =0.6)+
  geom_smooth(method ="lm", color ="red", se =FALSE)+
  theme_minimal()+
  labs(title ="Relacja między godzinami nauki a wynikiem egzaminu",
       x ="Godziny nauki w tygodniu",
       y ="Wynik egzaminu")
```

Prezentowany poniżej wykres wiolinowy pokazuje zależność pomiędzy zmienną *Parental_Involvment* a *Exam_Score*. W zbiorze zaanagażowanie rodziców określone jest w 3 stopniach - *Low*, *Medium* oraz *High*.

-   wysokie zaangażowanie rodziców - wyniki są z reguły wyższe niż w innych grupach, najczęściej występują wartości z przedziału 65-70

-   średnie zaangażowanie rodziców - wyniki skupiają się w przedziale 65-70, lecz na wysokości 70 wykres jest węższy niż dla grupy z wysokim zaangażowaniem

-   niskie zaangażowanie rodziców - wyniki skupiają się w okolicy wartości 65 i osiągają niższe wartości niż dwie pozostałe grupy

```{r echo=FALSE, warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement))+
  geom_violin()+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od zaangażowania rodziców",
       x ="Zaangażowanie rodziców",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set2")
```

Poniższy wykres słupkowy pokazuje typ szkół do których uczęszczają badani. Zdecydowana większość próbki uczęszcza do publicznych placówek edukacyjnych.

```{r echo=FALSE, warning=FALSE}
# Wykres słupkowy typów szkół
ggplot(dane_zwalidowane, aes(x = School_Type, fill = School_Type))+
  geom_bar()+
  theme_minimal()+
  labs(title ="Rozkład typów szkół",
       x ="Typ szkoły",
       y ="Liczba uczniów")+
  scale_fill_brewer(palette ="Set1")
```

Poniższy wykres pudełkowy prezentuje rozkład wyników w zależności od typu szkoły. Jak widać mediana (pogrubiona kreska) dla obu typów szkół znajduje się w okolicach wartości 67. Jednak widać różnice w rozstępie międzykwartylowym. Dla szkół prywatnych mieści się on w przedziale 65-70, a dla szkół publicznych 65-68. W szkołach prywatnych widać większy rozstęp wartości- występują wartości od 56 do 100, a dla szkół publicznych od 57 do 99.

```{r}
ggplot(dane_zwalidowane, aes(x = School_Type, y = Exam_Score, fill = School_Type))+
  geom_boxplot()+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od typów szkół",
       x ="Typ Szkoły",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set2")
```

Poniższe wykresy typu Boxplot pokazują zależności pomiędzy zmiennymi *Parental_Involvement*, *Motivation_Level* a *Exam_Scores*.

Interpretacja: Wyniki egzaminów są najwyższe wśród uczniów z wysoką motywacją, niezależnie od zaangażowania rodziców, choć wysokie zaangażowanie rodziców korzystnie wpływa na stabilność wyników. W grupie uczniów o niskiej i średniej motywacji wysokie zaangażowanie rodziców istotnie poprawia wyniki, podczas gdy niskie zaangazowanie skutkuje niższymi rezultatami. Rozrzut wyników jest większy w przypadku niskiej motywacji, co wskazuje na większe zróźnicowanie osiągnięć w tych grupach.

```{r echo=FALSE, warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement))+
  geom_boxplot()+
  facet_wrap(~ Motivation_Level)+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od motywacji i zaangażowania rodziców",
       x ="Zaangażowanie rodziców",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set3")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Access_to_Resources, y = Exam_Score, fill = Access_to_Resources))+
  geom_boxplot()+
  facet_wrap(~ Internet_Access)+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od dostępu do źródeł i internetu",
       x ="Dostęp do źródeł",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set5")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="steelblue", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Liczba uczniów")+
  facet_grid(~Learning_Disabilities)
```

```{r}
# Wykres heksagonalny
ggplot(dane_zwalidowane, aes(x = Distance_from_Home, y = Exam_Score)) +
  geom_hex(bins = 30) + # Liczba przedziałów (możesz dostosować np. 20, 40)
  scale_fill_viridis_c() + # Kolorystyka dla lepszej wizualizacji
  theme_minimal() +
  labs(
    title = "Zależność między wynikiem egzaminu a dystansem od domu",
    x = "Dystans od domu do szkoły",
    y = "Wynik Egzaminu",
    fill = "Gęstość"
  )
```

```{r}
ld_counts <- dane_zwalidowane %>%
  count(Learning_Disabilities)%>%
  mutate(Percentage =round(n /sum(n)*100,1))# Zaokrąglamy do 1 miejsca po przecinku# Tworzenie wykresu kołowego
ggplot(ld_counts, aes(x ="", y = n, fill = Learning_Disabilities))+
  geom_bar(stat ="identity", width =1)+
  coord_polar("y", start =0)+
  scale_fill_manual(values =c("Yes"="red","No"="lightblue"))+
  theme_void()+
  ggtitle("Udział osób z trudnościami w uczeniu się")+
  theme(plot.title = element_text(hjust =0.5))+
  geom_text(aes(label = paste0(Percentage,"%")), 
            position = position_stack(vjust =0.5), 
            color ="black", size =5)
```

```{r}
ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="darkred", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Poziom wykształcenia rodziców")+
  facet_grid(~Parental_Education_Level)
```

```{r}
# Upewniamy się, że kategorie są w poprawnej kolejności
dane_zwalidowane$Teacher_Quality <- factor(dane_zwalidowane$Teacher_Quality, levels =c("Low","Medium","High"))# Obliczenie mediany wyników egzaminów dla każdej kategorii jakości nauczycieli
median_scores <- dane_zwalidowane %>%
  group_by(Teacher_Quality)%>%
  summarise(Median_Exam_Score = median(Exam_Score, na.rm =TRUE))# Wykres liniowy z medianą
ggplot(median_scores, aes(x = Teacher_Quality, y = Median_Exam_Score, group =1))+
  geom_line(color ="#ff6347", size =1)+# Linia wykresu
  geom_point(color ="darkred", size =3)+# Punkty oznaczające medianę
  geom_text(aes(label =round(Median_Exam_Score,1)), vjust =-1)+# Etykiety mediany
  ylim(0,100)+# Skala od 0 do 100
  theme_minimal()+
  ggtitle("Mediana wyniku egzaminu a jakość nauczycieli")+
  xlab("Jakość nauczycieli")+
  ylab("Mediana wyniku egzaminu")+
  theme(plot.title = element_text(hjust =0.5))
```

```{r warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Family_Income, y = Tutoring_Sessions, color = Family_Income)) +
  geom_jitter(width = 0.2, alpha = 0.7) + # Dodanie punktów z małym zakłóceniem na osi X (w celu uniknięcia nakładania punktów)
  geom_smooth(method = "lm", se = FALSE, color = "black") + # Linia trendu (regresji liniowej)
  scale_color_manual(values = c("High" = "lightgreen", "Medium" = "lightblue", "Low" = "lightpink")) +
  theme_minimal() +
  labs(
    title = "Wpływ dochodów rodziny na liczbę korepetycji",
    x = "Dochód rodziny",
    y = "Liczba korepetycji",
    color = "Dochód"
  )
```

```{r}
ld_counts <- dane_zwalidowane %>%
  count(Family_Income)%>%
  mutate(Percentage =round(n /sum(n)*100,1))# Zaokrąglamy do 1 miejsca po przecinku# Tworzenie wykresu kołowego
ggplot(ld_counts, aes(x ="", y = n, fill = Family_Income))+
  geom_bar(stat ="identity", width =1)+
  coord_polar("y", start =0)+
  scale_fill_manual(values =c("Low"="lightpink","Medium"="lightblue","High"="lightgreen"))+
  theme_void()+
  ggtitle("Poziom dochodów rodziców")+
  theme(plot.title = element_text(hjust =0.5))+
  geom_text(aes(label = paste0(Percentage,"%")), 
            position = position_stack(vjust =0.5), 
            color ="black", size =5)
```

```{r warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Sleep_Hours, y = Exam_Score)) +
  geom_jitter(color = "purple", alpha = 0.5) +
  geom_smooth(method = "lm", color = "orange", se = TRUE) +
  theme_minimal() +
  labs(title = "Relacja między godzinami snu a wynikiem egzaminu",
       x = "Godziny snu",
       y = "Wynik egzaminu")
```

```{r}
# Ładowanie potrzebnych pakietów
library(dplyr)
library(gt)
library(tidyr)

# Używamy Twojego zbioru danych
data <- dane_zwalidowane

# Wyliczenie statystyk opisowych dla zmiennej Hours_Studied
stat_desc <- data %>%
  summarise(
    średnia = mean(Hours_Studied, na.rm = TRUE),
    mediana = median(Hours_Studied, na.rm = TRUE),
    odchylenie_standardowe = sd(Hours_Studied, na.rm = TRUE),
    minimum = min(Hours_Studied, na.rm = TRUE),
    maksimum = max(Hours_Studied, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) %>%
  mutate(zmienna = "Hours_Studied")  # Dodanie kolumny z nazwą zmiennej

# Tworzenie efektownej tabeli za pomocą gt
stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe: Hours_Studied",
    subtitle = "Podstawowe miary zmiennej"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    zmienna = "Zmienna",
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```

```{r}
 
# 1. Podstawowe informacje o danych
cat("Liczba rekordów:", nrow(dane_zwalidowane), "\n")
cat("Liczba zmiennych:", ncol(dane_zwalidowane), "\n")
 
# 2. Statystyki opisowe dla zmiennych ilościowych
zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Family_Income, Physical_Activity, Exam_Score)
 
statystyki_opisowe <- zmienne_ilosciowe %>%
  summarise_all(list(
    Średnia = ~mean(., na.rm = TRUE),
    Mediana = ~median(., na.rm = TRUE),
    Odchylenie_std = ~sd(., na.rm = TRUE),
    Min = ~min(., na.rm = TRUE),
    Max = ~max(., na.rm = TRUE)
  ))
 
print(statystyki_opisowe)
 
# 3. Rozkład zmiennych jakościowych
zmienne_jakosciowe <- dane_zwalidowane %>%
  select(Parental_Involvement, Access_to_Resources, Extracurricular_Activities, 
         Motivation_Level, Internet_Access, Teacher_Quality, 
         School_Type, Peer_Influence, Learning_Disabilities, Gender)
str(zmienne_jakosciowe)
rozklad_jakosciowe <- zmienne_jakosciowe %>%
  summarise_all(~prop.table(table(.)) * 100)
 
print(rozklad_jakosciowe)
 
# 4. Macierz korelacji dla zmiennych ilościowych
macierz_korelacji <- cor(zmienne_ilosciowe, use = "complete.obs")
print(macierz_korelacji)
 
# Wizualizacja macierzy korelacji
corrplot(macierz_korelacji, method = "circle", type = "upper", 
         tl.col = "black", tl.srt = 45, col = colorRampPalette(c("blue", "white", "red"))(200))
 
# 5. Wizualizacje pomocnicze
# Rozkład wyniku egzaminu
ggplot(dane, aes(x = Exam_Score)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Rozkład wyniku egzaminu", x = "Wynik egzaminu", y = "Liczba uczniów")
 
# Wykres pudełkowy: Wynik egzaminu vs. poziom zaangażowania rodziców
ggplot(dane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement)) +
  geom_boxplot() +
  labs(title = "Wynik egzaminu w zależności od zaangażowania rodziców", 
       x = "Poziom zaangażowania rodziców", y = "Wynik egzaminu") +
  theme_minimal()
 
# Wynik egzaminu vs. czas nauki
ggplot(dane, aes(x = Hours_Studied, y = Exam_Score)) +
  geom_point(color = "blue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Zależność między godzinami nauki a wynikiem egzaminu", 
       x = "Liczba godzin nauki", y = "Wynik egzaminu") +
  theme_minimal()
 
# Wynik egzaminu vs. motywacja
ggplot(dane, aes(x = Motivation_Level, y = Exam_Score, fill = Motivation_Level)) +
  geom_boxplot() +
  labs(title = "Wynik egzaminu w zależności od poziomu motywacji", 
       x = "Poziom motywacji", y = "Wynik egzaminu") +
  theme_minimal()
 
# Wynik egzaminu vs. trudności w uczeniu się
ggplot(dane, aes(x = Learning_Disabilities, y = Exam_Score, fill = Learning_Disabilities)) +
  geom_boxplot() +
  labs(title = "Wynik egzaminu w zależności od trudności w uczeniu się", 
       x = "Trudności w uczeniu się", y = "Wynik egzaminu") +
  theme_minimal()
```

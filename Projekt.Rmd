---
title: "Projekt"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

# Wstęp

## Opis problemu

Problemem, który analizujemy w niniejszym projekcie jest wpływ poszczególnych czynników na wynik końcowy ucznia (?)

## Baza danych

Baza danych którą analizujemy nazywa się „Wyniki uczniów”. Znajduje się w niej 20 kolumn z danymi oraz 6.608 wierszy danych. W bazie danych znajdują się zarówno zmienne liczbowe jak i jakościowe.

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(tidyverse)
library(VIM)
library(outliers)
library(naniar)
library(dplyr)
library(hot.deck)
library(dlookr)
library(validate)
library(errorlocate)
library(datarium)
library(ggplot2)
library(gridExtra)
library(hexbin)
library(knitr)
library(gt)
library(corrplot)
library(tidyr)
```

```{r}
czynniki <- read.csv("czynniki.csv")
glimpse(czynniki)
```

# Czyszczenie danych

W niniejszym rozdziale sprawdzimy jakość danych, zbadamy występowanie braków danych oraz dobierzemy odpowiednią metodę imputacji brakujących danych (jeżeli zajdzie taka potrzeba).

## Walidacja danych

Zostało wykonane badanie danych za pomocą funkcji *aggr*. Wykres po lewej stronie prezentuje proporcje braków danych. W naszym przypadku największe braki występują w trzech zmiennych:

-   Sleep Hours - 5,22%
-   Exam Score - 4,37%
-   Distance from Home - 1,01%

Tabela po prawej stronie ilistruje współwystępowanie braków w zestawie danych. Czerwone pola oznaczają brakujące wartości. Można zauważyć, że brakujące dane są dość rozporoszone i nie występują jednocześnie w wielu zmiennych. Oznacza to, że nie instnieje współzależność pomiędzy występowaniem braków więc dane brakujące będziemy uzupełniać za pomocą podobieństwa.

```{r}
aggr(czynniki, numbers = TRUE, sortVars = TRUE)
```

```{r}
gg_miss_upset(czynniki)
```

Wykres poniżej został stworzony za pomocą funkcji *gg_miss_upset*. Prezentuje on wartości liczbowe brakujących danych

-   Family income – 309
-   Sleep Hours – 300

Z uwagi na stosunkowo wysoką ilość braków dokonamy imputacji danych.

```{r}
czynniki1<- czynniki[!is.na(czynniki$Family_Income), ]
czynniki2<- czynniki1[!is.na(czynniki1$Parental_Education_Level), ]
czynniki3<- czynniki2[!is.na(czynniki2$Teacher_Quality), ]
czynniki4<- czynniki3[!is.na(czynniki3$Distance_from_Home), ]
unique(czynniki4$Family_Income)
unique(czynniki4$Parental_Education_Level)
unique(czynniki4$Teacher_Quality)
unique(czynniki4$Distance_from_Home)
glimpse(czynniki4)
```

```{r}
gg_miss_upset(czynniki4)
```

```{r}
aggr(czynniki4, numbers = TRUE, sortVars = TRUE)
```

## Imputacja danych

```{r}
as.numeric(czynniki4$Exam_Score)
as.numeric(czynniki4$Sleep_Hours)
czynniki5 <- hotdeck(czynniki4)
```

```{r}
miss_var_summary(czynniki5)
```

## Reguły walidacyjne

```{r}
rules <- validator(
Hours_Studied >= 0,
Hours_Studied <= 168,
Attendance >= 0, 
Attendance <= 100,
Sleep_Hours >= 0,
Sleep_Hours <= 24, 
Previous_Scores >= 0, 
Previous_Scores <= 100, 
Physical_Activity >= 0,
Physical_Activity <= 168,
Exam_Score >= 0,
Exam_Score <= 100,
Sleep_Hours * 7 + Hours_Studied + Physical_Activity >= 0,
Sleep_Hours * 7 + Hours_Studied + Physical_Activity <= 168
)

wyniki <- confront(czynniki5, rules)
summary(wyniki)
plot(wyniki)

dane_zwalidowane <- czynniki5 %>%
  replace_errors(rules)
errors_removed(dane_zwalidowane)
```

```{r include=FALSE}
boxplot(czynniki$Hours_Studied, main="Hours Studied") 
outliers <- boxplot.stats(dane_zwalidowane$Hours_Studied)$out 
print(outliers)
boxplot(czynniki$Attendance, main="Attendance")
outliers1 <- boxplot.stats(dane_zwalidowane$Attendance)$out 
print(outliers1)
boxplot(czynniki$Sleep_Hours, main="Sllep Hours")
outliers2 <- boxplot.stats(dane_zwalidowane$Sllep_hours)$out 
print(outliers2)
boxplot(czynniki$Previous_Scores, main="Previos Scores")
outliers3 <- boxplot.stats(dane_zwalidowane$Previous_Scores)$out 
print(outliers3)
boxplot(czynniki$Tutoring_Sessions, main="Tutoring Sessions")
outliers4 <- boxplot.stats(dane_zwalidowane$Tutoring_Sessions)$out 
print(outliers4)
boxplot(czynniki$Exam_Score, main="Exam Score")
outliers5 <- boxplot.stats(dane_zwalidowane$Exam_Score)$out 
print(outliers5)
```

```{r}
par(mfrow=c(2,3))
boxplot(dane_zwalidowane$Hours_Studied, main="Hours Studied") 
boxplot(dane_zwalidowane$Attendance, main="Attendance")
boxplot(dane_zwalidowane$Sleep_Hours, main="Sllep Hours")
boxplot(dane_zwalidowane$Previous_Scores, main="Previos Scores")
boxplot(dane_zwalidowane$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(dane_zwalidowane$Exam_Score, main="Exam Score")
par(mfrow=c(2,3)) #zmienić przy kolejnych wykresach na c(1,1) bo będzie pamiętać i tworzyć wykresy w blokach 6- wykresowych
boxplot(dane_zwalidowane$Hours_Studied, main="Hours Studied") 
boxplot(dane_zwalidowane$Attendance, main="Attendance")
boxplot(dane_zwalidowane$Sleep_Hours, main="Sllep Hours")
boxplot(dane_zwalidowane$Previous_Scores, main="Previos Scores")
boxplot(dane_zwalidowane$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(dane_zwalidowane$Exam_Score, main="Exam Score")

```

```{r warning=FALSE}
ggplot(dane_zwalidowane, aes(x=Attendance)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Hours_Studied)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Sleep_Hours)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Previous_Scores)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Tutoring_Sessions)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
ggplot(dane_zwalidowane, aes(x=Exam_Score)) +
  geom_boxplot() +
  theme_bw() +
  coord_flip()
```

```{r}
grubbs.test(dane_zwalidowane$Hours_Studied)
grubbs.test(dane_zwalidowane$Attendance)
grubbs.test(dane_zwalidowane$Sleep_Hours)
grubbs.test(dane_zwalidowane$Previous_Scores)
grubbs.test(dane_zwalidowane$Tutoring_Sessions)
grubbs.test(dane_zwalidowane$Exam_Score)
```

```{r}
ggplot(dane_zwalidowane, aes(x = Gender, fill = Gender))+
  geom_bar()+
  scale_fill_manual(values =c("Female"="pink","Male"="lightblue"))+
  theme_minimal()+
  ggtitle("Podział płci w próbie")+
  theme(plot.title = element_text(hjust =0.5))
```

```{r}
ggplot(dane_zwalidowane, aes(x = Exam_Score, fill = Exam_Score))+
  geom_histogram(binwidth =5,fill="#5C1C81", color ="black")+
  theme_minimal()+
  ggtitle("Rozkład wyników egzaminów")+
  theme(plot.title = element_text(hjust =0.5))
```

```{r}
 w1 <- ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="steelblue", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Liczba uczniów")+
  facet_grid(~Gender)
w2 <-ggplot(dane_zwalidowane, aes(x = Hours_Studied))+
  geom_histogram(binwidth =5, fill ="darkgreen", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład godzin nauki", x ="Godziny nauki w tygodniu", y="Liczba uczniów")+
  facet_grid(~Gender)
grid.arrange(w1, w2, nrow = 1)
```

```{r}
ggplot(dane_zwalidowane, aes(x = Hours_Studied, y = Exam_Score))+
  geom_point(color ="blue", alpha =0.6)+
  geom_smooth(method ="lm", color ="red", se =FALSE)+
  theme_minimal()+
  labs(title ="Relacja między godzinami nauki a wynikiem egzaminu",
       x ="Godziny nauki w tygodniu",
       y ="Wynik egzaminu")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement))+
  geom_violin()+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od zaangażowania rodziców",
       x ="Zaangażowanie rodziców",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set2")
```

```{r}
# Wykres słupkowy typów szkół
ggplot(dane_zwalidowane, aes(x = School_Type, fill = School_Type))+
  geom_bar()+
  theme_minimal()+
  labs(title ="Rozkład typów szkół",
       x ="Typ szkoły",
       y ="Liczba uczniów")+
  scale_fill_brewer(palette ="Set1")
```

```{r}
ggplot(dane_zwalidowane, aes(x = School_Type, y = Exam_Score, fill = School_Type))+
  geom_boxplot()+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od typów szkół",
       x ="Typ Szkoły",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set2")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement))+
  geom_boxplot()+
  facet_wrap(~ Motivation_Level)+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od motywacji i zaangażowania rodziców",
       x ="Zaangażowanie rodziców",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set3")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Access_to_Resources, y = Exam_Score, fill = Access_to_Resources))+
  geom_boxplot()+
  facet_wrap(~ Internet_Access)+
  theme_minimal()+
  labs(title ="Wyniki egzaminów w zależności od dostępu do źródeł i internetu",
       x ="Dostęp do źródeł",
       y ="Wynik egzaminu")+
  scale_fill_brewer(palette ="Set5")
```

```{r}
ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="steelblue", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Liczba uczniów")+
  facet_grid(~Learning_Disabilities)
```

```{r}
# Wykres heksagonalny
ggplot(dane_zwalidowane, aes(x = Distance_from_Home, y = Exam_Score)) +
  geom_hex(bins = 30) + # Liczba przedziałów (możesz dostosować np. 20, 40)
  scale_fill_viridis_c() + # Kolorystyka dla lepszej wizualizacji
  theme_minimal() +
  labs(
    title = "Zależność między wynikiem egzaminu a dystansem od domu",
    x = "Dystans od domu do szkoły",
    y = "Wynik Egzaminu",
    fill = "Gęstość"
  )
```

```{r}
ld_counts <- dane_zwalidowane %>%
  count(Learning_Disabilities)%>%
  mutate(Percentage =round(n /sum(n)*100,1))# Zaokrąglamy do 1 miejsca po przecinku# Tworzenie wykresu kołowego
ggplot(ld_counts, aes(x ="", y = n, fill = Learning_Disabilities))+
  geom_bar(stat ="identity", width =1)+
  coord_polar("y", start =0)+
  scale_fill_manual(values =c("Yes"="red","No"="lightblue"))+
  theme_void()+
  ggtitle("Udział osób z trudnościami w uczeniu się")+
  theme(plot.title = element_text(hjust =0.5))+
  geom_text(aes(label = paste0(Percentage,"%")), 
            position = position_stack(vjust =0.5), 
            color ="black", size =5)
```

```{r}
ggplot(dane_zwalidowane, aes(x = Exam_Score))+
  geom_histogram(binwidth =5, fill ="darkred", color ="black")+
  theme_minimal()+
  labs(title ="Rozkład wyników egzaminów", x ="Wynik egzaminu", y ="Poziom wykształcenia rodziców")+
  facet_grid(~Parental_Education_Level)
```

```{r}
# Upewniamy się, że kategorie są w poprawnej kolejności
dane_zwalidowane$Teacher_Quality <- factor(dane_zwalidowane$Teacher_Quality, levels =c("Low","Medium","High"))# Obliczenie mediany wyników egzaminów dla każdej kategorii jakości nauczycieli
median_scores <- dane_zwalidowane %>%
  group_by(Teacher_Quality)%>%
  summarise(Median_Exam_Score = median(Exam_Score, na.rm =TRUE))# Wykres liniowy z medianą
ggplot(median_scores, aes(x = Teacher_Quality, y = Median_Exam_Score, group =1))+
  geom_line(color ="#ff6347", size =1)+# Linia wykresu
  geom_point(color ="darkred", size =3)+# Punkty oznaczające medianę
  geom_text(aes(label =round(Median_Exam_Score,1)), vjust =-1)+# Etykiety mediany
  ylim(0,100)+# Skala od 0 do 100
  theme_minimal()+
  ggtitle("Mediana wyniku egzaminu a jakość nauczycieli")+
  xlab("Jakość nauczycieli")+
  ylab("Mediana wyniku egzaminu")+
  theme(plot.title = element_text(hjust =0.5))
```

```{r warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Family_Income, y = Tutoring_Sessions, color = Family_Income)) +
  geom_jitter(width = 0.2, alpha = 0.7) + # Dodanie punktów z małym zakłóceniem na osi X (w celu uniknięcia nakładania punktów)
  geom_smooth(method = "lm", se = FALSE, color = "black") + # Linia trendu (regresji liniowej)
  scale_color_manual(values = c("High" = "lightgreen", "Medium" = "lightblue", "Low" = "lightpink")) +
  theme_minimal() +
  labs(
    title = "Wpływ dochodów rodziny na liczbę korepetycji",
    x = "Dochód rodziny",
    y = "Liczba korepetycji",
    color = "Dochód"
  )
```

```{r}
ld_counts <- dane_zwalidowane %>%
  count(Family_Income)%>%
  mutate(Percentage =round(n /sum(n)*100,1))# Zaokrąglamy do 1 miejsca po przecinku# Tworzenie wykresu kołowego
ggplot(ld_counts, aes(x ="", y = n, fill = Family_Income))+
  geom_bar(stat ="identity", width =1)+
  coord_polar("y", start =0)+
  scale_fill_manual(values =c("Low"="lightpink","Medium"="lightblue","High"="lightgreen"))+
  theme_void()+
  ggtitle("Poziom dochodów rodziców")+
  theme(plot.title = element_text(hjust =0.5))+
  geom_text(aes(label = paste0(Percentage,"%")), 
            position = position_stack(vjust =0.5), 
            color ="black", size =5)
```

```{r warning=FALSE}
ggplot(dane_zwalidowane, aes(x = Sleep_Hours, y = Exam_Score)) +
  geom_jitter(color = "purple", alpha = 0.5) +
  geom_smooth(method = "lm", color = "orange", se = TRUE) +
  theme_minimal() +
  labs(title = "Relacja między godzinami snu a wynikiem egzaminu",
       x = "Godziny snu",
       y = "Wynik egzaminu")
```

```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Hours_Studied
stat_desc <- data %>%
  summarise(
    średnia = mean(Hours_Studied, na.rm = TRUE),
    mediana = median(Hours_Studied, na.rm = TRUE),
    odchylenie_standardowe = sd(Hours_Studied, na.rm = TRUE),
    minimum = min(Hours_Studied, na.rm = TRUE),
    maksimum = max(Hours_Studied, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 

stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Hours_Studied"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```
 
```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Attendance
stat_desc <- data %>%
  summarise(
    średnia = mean(Attendance, na.rm = TRUE),
    mediana = median(Attendance, na.rm = TRUE),
    odchylenie_standardowe = sd(Attendance, na.rm = TRUE),
    minimum = min(Attendance, na.rm = TRUE),
    maksimum = max(Attendance, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 


stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Attendance"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```


```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Sleep_Hours
stat_desc <- data %>%
  summarise(
    średnia = mean(Sleep_Hours, na.rm = TRUE),
    mediana = median(Sleep_Hours, na.rm = TRUE),
    odchylenie_standardowe = sd(Sleep_Hours, na.rm = TRUE),
    minimum = min(Sleep_Hours, na.rm = TRUE),
    maksimum = max(Sleep_Hours, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 

stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Sleep_Hours"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```

```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Tutoring_Sessions
stat_desc <- data %>%
  summarise(
    średnia = mean(Tutoring_Sessions, na.rm = TRUE),
    mediana = median(Tutoring_Sessions, na.rm = TRUE),
    odchylenie_standardowe = sd(Tutoring_Sessions, na.rm = TRUE),
    minimum = min(Tutoring_Sessions, na.rm = TRUE),
    maksimum = max(Tutoring_Sessions, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 

stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Tutoring_Sessions"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```

```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Physical_Activity
stat_desc <- data %>%
  summarise(
    średnia = mean(Physical_Activity, na.rm = TRUE),
    mediana = median(Physical_Activity, na.rm = TRUE),
    odchylenie_standardowe = sd(Physical_Activity, na.rm = TRUE),
    minimum = min(Physical_Activity, na.rm = TRUE),
    maksimum = max(Physical_Activity, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 


stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Physical_Activity"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```
```{r}

zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)

data <- zmienne_ilosciowe
# Wyliczenie statystyk opisowych dla zmiennej Exam_Score
stat_desc <- data %>%
  summarise(
    średnia = mean(Exam_Score, na.rm = TRUE),
    mediana = median(Exam_Score, na.rm = TRUE),
    odchylenie_standardowe = sd(Exam_Score, na.rm = TRUE),
    minimum = min(Exam_Score, na.rm = TRUE),
    maksimum = max(Exam_Score, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = everything(),  # Wszystkie kolumny przekształcamy w długą tabelę
    names_to = "Statystyka",
    values_to = "Wartość"
  ) 


stat_desc %>%
  gt() %>%
  tab_header(
    title = "Statystyki Opisowe:",
    subtitle = "Exam_Score"
  ) %>%
  fmt_number(
    columns = Wartość,
    decimals = 2
  ) %>%
  data_color(
    columns = Wartość,
    colors = scales::col_numeric(
      palette = c("purple", "pink", "lightblue"),
      domain = NULL
    )
  ) %>%
  cols_label(
    Statystyka = "Rodzaj statystyki",
    Wartość = "Wartość"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
```
```{r}
 
 
# Statystyki opisowe dla zmiennych ilościowych
zmienne_ilosciowe <- dane_zwalidowane %>%
  select(Hours_Studied, Attendance, Sleep_Hours, Previous_Scores, 
         Tutoring_Sessions, Physical_Activity, Exam_Score)


 
#. Macierz korelacji dla zmiennych ilościowych
macierz_korelacji <- cor(zmienne_ilosciowe, use = "complete.obs")
print(macierz_korelacji)
 
# Wizualizacja macierzy korelacji
corrplot(macierz_korelacji, method = "circle", type = "upper", 
         tl.col = "black", tl.srt = 45, col = colorRampPalette(c("blue", "white", "red"))(200))

```


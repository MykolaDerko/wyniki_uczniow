---
title: "Projekt"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(tidyverse)
library(VIM)
library(outliers)
library(naniar)
library(dplyr)
library(hot.deck)
library(dlookr)
```

```{r}
glimpse(czynniki)
```

```{r}
aggr(czynniki, numbers = TRUE, sortVars = TRUE)
```
```{r}
gg_miss_upset(czynniki)
```

# WNIOSKI

## Tabela 1.

Tabela pokazuje szczegóły proporcji braków dla pierwszych zmiennych w zestawie danych.

Najwięcej braków występuje w:

Sleep_Hours (5,38%)

Family_Income (5,15%)

Parental_Education_Level (1,4%)

Pozostałe zmienne w tej tabeli mają bardzo niewielką lub zerową liczbę braków.

## Lewy panel (Proportion of missings)

Lewy panel pokazuje proporcje braków dla każdej zmiennej. Wykres słupkowy wskazuje, że zmienne takie jak Sleep_Hours i Family_Income mają około 5% braków, podczas gdy pozostałe zmienne mają znacznie mniejszy udział braków lub wcale ich nie mają.

## Prawy panel (Combinations)

Prawy panel ilustruje współwystępowanie braków w zestawie danych. Każda kolumna to jedna zmienna. Czerwone pola oznaczają brakujące wartości. Można zauważyć, że brakujące dane są dość rozproszone i nie występują jednocześnie w wielu zmiennych.Oznacza to, że nie istnieje współzależność pomiędzy występowaniem braków więc dane brakujące będziemy uzupełniać za pomocą podobieństw.

## Podsumowanie wniosków:

Skala braków: Tylko kilka zmiennych ma zauważalne braki (Sleep_Hours, Family_Income), które należy uwzględnić w dalszej analizie (np. imputacja lub usunięcie wierszy z brakami).

Brak współwystępowania braków: Z wykresu wynika, że brakujące dane nie są mocno powiązane między zmiennymi — brak jednych wartości nie oznacza automatycznie braków w innych.

Czystość danych: Większość zmiennych w zestawie danych jest kompletna.


```{r}
czynniki1<- czynniki[!is.na(czynniki$Family_Income), ]
czynniki2<- czynniki1[!is.na(czynniki1$Parental_Education_Level), ]
czynniki3<- czynniki2[!is.na(czynniki2$Teacher_Quality), ]
czynniki4<- czynniki3[!is.na(czynniki3$Distance_from_Home), ]
unique(czynniki4$Family_Income)
unique(czynniki4$Parental_Education_Level)
unique(czynniki4$Teacher_Quality)
unique(czynniki4$Distance_from_Home)
glimpse(czynniki4)
```
```{r}
gg_miss_upset(czynniki4)
```
```{r}
aggr(czynniki4, numbers = TRUE, sortVars = TRUE)
```

```{r}
as.numeric(czynniki4$Exam_Score)
as.numeric(czynniki4$Sleep_Hours)
czynniki5 <- hot.deck(czynniki4)
print1(czynniki5$Sleep_Hours)
print2(czynniki5$Exam_Score)
```

```{r}
miss_var_summary(czynniki4)
```

```{r}
as.numeric(czynniki4$Exam_Score)
as.numeric(czynniki4$Sleep_Hours)
czynniki5 <- czynniki4
czynniki5$Exam_Score<- imputate_outlier(czynniki5, Exam_Score)
czynniki5$Sleep_Hours <- imputate_outlier(czynniki5, Sleep_Hours)
```

```{r include=FALSE}
boxplot(czynniki$Hours_Studied, main="Hours Studied") 
outliers <- boxplot.stats(czynniki$Hours_Studied)$out 
print(outliers)
boxplot(czynniki$Attendance, main="Attendance")
outliers1 <- boxplot.stats(czynniki$Attendance)$out 
print(outliers1)
boxplot(czynniki$Sleep_Hours, main="Sllep Hours")
outliers2 <- boxplot.stats(czynniki$Sllep_hours)$out 
print(outliers2)
boxplot(czynniki$Previous_Scores, main="Previos Scores")
outliers3 <- boxplot.stats(czynniki$Previous_Scores)$out 
print(outliers3)
boxplot(czynniki$Tutoring_Sessions, main="Tutoring Sessions")
outliers4 <- boxplot.stats(czynniki$Tutoring_Sessions)$out 
print(outliers4)
boxplot(czynniki$Exam_Score, main="Exam Score")
outliers5 <- boxplot.stats(czynniki$Exam_Score)$out 
print(outliers5)
```

```{r}
par(mfrow=c(2,3))
boxplot(czynniki$Hours_Studied, main="Hours Studied") 
boxplot(czynniki$Attendance, main="Attendance")
boxplot(czynniki$Sleep_Hours, main="Sllep Hours")
boxplot(czynniki$Previous_Scores, main="Previos Scores")
boxplot(czynniki$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(czynniki$Exam_Score, main="Exam Score")
par(mfrow=c(2,3)) #zmienić przy kolejnych wykresach na c(1,1) bo będzie pamiętać i tworzyć wykresy w blokach 6- wykresowych
boxplot(data_new$Hours_Studied, main="Hours Studied") 
boxplot(data_new$Attendance, main="Attendance")
boxplot(data_new$Sleep_Hours, main="Sllep Hours")
boxplot(data_new$Previous_Scores, main="Previos Scores")
boxplot(data_new$Tutoring_Sessions, main="Tutoring Sessions")
boxplot(data_new$Exam_Score, main="Exam Score")

```

```{r}
grubbs.test(czynniki$Hours_Studied)
grubbs.test(czynniki$Attendance)
grubbs.test(czynniki$Sleep_Hours)
grubbs.test(czynniki$Previous_Scores)
grubbs.test(czynniki$Tutoring_Sessions)
grubbs.test(czynniki$Exam_Score)
```
